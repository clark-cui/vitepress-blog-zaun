---
title: 虚拟机配置
description: 配置虚拟机开发环境
aside: false
date: 2022-01-20
tags:
  - 环境配置
---

### linux shell

- mv [OPTIONS] source destination 将一个文件或目录重命名或移动到另一个位置
- pwd 打印当前位置
- vi 编辑当前文件
- nano 一些 Linux 系统默认文件编辑器，比 vim 简单，^ 是 ctrl,M-是 alt，但是我们[应该把他修改为 vim](https://www.cnblogs.com/kaishirenshi/p/12194312.html)
- ls (ls -a 展示所有文件) 展示文件
- mkdir 创建文件夹
- touch 创建文件
- cp [options] source dest ( -r 若给出的源文件是一个目录文件，此时将复制该目录下所有的子目录和文件) 复制文件
- cat /etc/passwd 查看用户信息
- sudo adduser username 创建用户（用户的目录在/home/user）
- sudo usermod -aG sudo username 把用户添加到 sudo 组（拥有 sudo 访问权限）
- sudo deluser username 删除用户
- sudo deluser --remove-home username 删除用户并且删除用户的家目录
- su user 切换用户(切换 root 需要 sudo su root，重开 terminal 默认就是 root)
- sudo passwd user (root 用户操作，重置密码,密码存储在 bitwarden)
- 配置不同用户的环境
  - 修改所有用户的环境变量：/etc/profile 文件
  - 只修改 root 用户的环境变量：~/.bashrc 文件（也就是/root/.bashrc）
  - 只修改某个非 root 用户的环境变量：/home/非 root 用户名/.bashrc 文件
  - 理论上的最佳实践是，开启 wsl2，新建一个 root 组的用户 clark,然后所有配置都在 clark 用户操作，因为 electron build 如果是 root 用户会有问题（需要加 --no-sandbox，如果是依赖的话就加不了这一行）

### 安装 VMware

- 先在 423down 搜索 VMware Workstation PRO(阿里云盘里有 16 版本)
- 安装，安装时注意勾选 WHP，为了兼容 windows 的 Linux 子系统的虚拟机 Hyper-v
- 其他均默认即可

### 安装 Linuxmint

- [linuxmint 官网下载 cinnamon edition 版本的 iso](https://linuxmint.com/download.php)
- 打开 vmware，创建新的虚拟机，选择自定义（高级），均默认，注意选择 iso 的文件地址，然后一直完成后即可
- Start linux mint，进入桌面后，点击桌面光盘 install linux mint，如果没反应就重启试试，这时候是有点卡，然后全都默认设置，设置下 root 用户和密码，完成后重启
- 此时桌面是小窗，还有点卡，点击 Vmware 的设置栏“虚拟机”，点击"安装 VMware tools"，如果这一栏是灰色，则[按照这里操作](https://www.jianshu.com/p/af4313d92fee)，也就是先关闭虚拟机，选择虚拟机设置，添加“软盘”，添加“CD/DVD”,使用物理驱动器连接，然后开启虚拟机，点击“重新安装 VMware Tools”
- 桌面会有 VMware Tools 的软盘，点击打开，再点击打开 vmwareTools-10.3.10-13333.tar.gz,点击工具栏的“Extract”，选择目录“DownLoads”，然后打开 terminal，sudo su root,进入 DownLoads 目录，进入该文件夹， ./vmware-install.pl 执行安装脚本，然后一路回车即可安装完成，参考[这里的后半段](https://blog.csdn.net/weixin_43059285/article/details/103352682)
- 编辑虚拟机设置，选项，共享文件夹，选择总是启用（方便文件传输），然后添加一个文件夹用于 share,此文件夹在虚拟机的路径是/mnt/hgfs/filesName
- 编辑虚拟机设置，选项，高级，为启用了 Hyper-V 的主机禁用侧通道缓解（提升性能）
- 里面安装 cfw，下载 tar.gz 文件，双击打开，点击 extract 解压缩，然后在当前打开命令行，输入./cfw，
- 然后配置本机走 cfw 的代理即可（里面的 firefox 浏览器默认是走的本机的配置，所以只需要配置本机代理接口，设置-network-proxy，manual-设置 127.0.0.1:8080,把 cfw 的端口改成 8080,并设置为开机启动）
- 代理这里会有一点问题，就是虚拟机里面开不了 tun mode，只能手动配置代理，其实不太方便，虚拟机的网络走的是 NAT 模式，网络上有把其改为桥接模式，然后外围的 windows 的 clash 开启 lan，里面连接外围代理的设置，但我觉得没有我的这种好
- 目前遗留了一个 bug，就是 VMtools 的跨系统自动鼠标指针和跨系统的复制粘贴不能用，不清楚是什么原因，查了下，应该是 VMtools 的部分功能没起作用，在配置了试了下，没啥用。目前是可用状态，就不折腾了

### 安装manjaro-kde

- [官网下载对应 iso](https://manjaro.org/downloads/official/kde/)，下载后文件放入对应位置
- 安装过程一致，选择经典，但是自己把内存调大点，注意，语言一定要选择英文，不然最后文件夹名会是中文（如果不小心弄了中文，除了重装，还有曲线救国的方法[链接](https://segmentfault.com/a/1190000037454534)），在命令行里就是很长的一串字符，特别麻烦，选完后，编辑配置，高级，设置共享文件夹和禁用侧通道，然后开启虚拟机，安装系统
- [我使用的分区信息都在这里，参考链接](https://www.liangzl.com/get-article-detail-206412.html)
- [参考链接二，我的炫龙里的镜像没有使用这个，但是可以参考](https://blog.csdn.net/cxy1430826258/article/details/105050867)
- 安装太慢了...对比 mint 配置也很繁琐...但是界面真的很新颖，跟 mint 上个世纪的页面比，好看很多
- 如果分辨率有问题，重启下虚拟机就好了
- 然后就是配置软件源，设置代理软件（安装 cfw），安装常用软件
- 配置下中文输入法，alt+space 唤起搜索，输入 input，进入 config，选择 Pinyin, shortcut 里有写 ctrl+space 切换输入法
- 在 linux-mint 中，无法复制粘贴和无法拖动文件的 bug 在这里却没有复现，但是共享文件夹却没有挂载到/mnt/目录，也不知道为啥...[参考这里的链接应该能解决](https://zhuanlan.zhihu.com/p/344845390)，我就不折腾了，都能复制粘贴了，我还要共享文件夹干嘛...
- 最后遗留一个坑，~~cfw 是装上了，但是系统代理配置了没起作用，没时间折腾了，下次有机会再看吧，做饭了~~ 系统代理设置了，火狐浏览器设置自动跟随系统无效，设置手动 127.0.0.1:8080 后成功

### 总结

- 不同的镜像竟然有不同的坑,linux 桌面端果然是个大坑...坚定了我继续用 windows+wsl2 的道路...或者直接用 mac 也行，啥都帮我弄好了，相信 less is more
